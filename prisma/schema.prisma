generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
}

model Node {
  id          String    @id @default(cuid())
  title       String
  content     String
  depth       Int
  lens        String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  sources     Source[]
  children    Node[]    @relation("NodeConnections")
  parents     Node[]    @relation("NodeConnections")
  conflicts   Conflict[] @relation("ConflictNodes")
}

model Source {
  id        String   @id @default(cuid())
  url       String
  title     String?
  nodeId    String
  node      Node     @relation(fields: [nodeId], references: [id])
  createdAt DateTime @default(now())
}

model Conflict {
  id          String   @id @default(cuid())
  description String
  createdAt   DateTime @default(now())
  nodes       Node[]   @relation("ConflictNodes")
}